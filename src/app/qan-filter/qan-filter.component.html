<aside [class.filter-menu--open]="isToggleMenu" class="filter-menu">
  <div class="filter-menu__header">
    <button (click)="isToggleMenu = !isToggleMenu" class="filter-menu__toggle hamburger-button">
      <i class="fa fa-list" aria-hidden="true"></i>
    </button>
    <div *ngIf="isToggleMenu" class="filter-menu__title">
      <span class="title-text">Filter by</span>
      <button (click)="isToggleMenu = !isToggleMenu" class="filter-menu__close">
        <i class="fa fa-times" aria-hidden="true"></i>
      </button>
    </div>
  </div>
  <section *ngIf="isToggleMenu" class="filter-menu__body">
    <form class="query-search query-search--clicked column-configuration__search">
      <input (keyup)="findFilters(filterSearchValue)"
             [(ngModel)]="filterSearchValue"
             name="searchValue"
             class="input-field query-search__input column-configuration__input"
             type="text" placeholder="Type to search">
      <button class="query-search__button column-configuration__button" type="submit">
        <i class="fa fa-search"></i>
      </button>
    </form>

    <ngb-tabset class="pmm-tabset">
      <ngb-tab class="pmm-tab">
        <ng-template ngbTabTitle class="pmm-tab-title"><span>Filters</span></ng-template>
        <ng-template ngbTabContent class="pmm-tab-content">
          <div *ngFor="let filterGroup of filtersSearchedValues" class="filter-menu__filter-group">
            <div class="filter-group__title">
              <span class="title-text {{filterGroup.name.toLowerCase()}}">
                {{filterGroup.name}} ({{countChecked(filterGroup.values)}}/{{filterGroup.values.length}}):
              </span>
              <div *ngIf="filterGroup.values.length > mainLimit" class="see-all-wrapper">
                <button (click)="getAll(filterGroup)" class="see-all">
                  {{limits[filterGroup.name] <= mainLimit ? 'see all' : 'short list'}}
                </button>
              </div>
            </div>
            <div class="filter-group__filters">
              <ng-container *ngFor="let value of filterGroup.values; let index = index">
                <label *ngIf="index <= limits[filterGroup.name]" class="checkbox-container">
                  <input (change)="saveConfiguration(filterGroup, value)"
                         [(ngModel)]="value.state"
                         type="checkbox"
                         class="checkbox-container__main-input">
                  <span class="checkbox-container__checkmark"></span>
                  <span class="checkbox-container__label-text">{{value.filterName}}</span>
                </label>
              </ng-container>
            </div>
          </div>
        </ng-template>
      </ngb-tab>
      <ngb-tab>
        <ng-template ngbTabTitle><span>Checked</span></ng-template>
        <ng-template ngbTabContent>
          <div class="checked-content">
            <!--<div  class="selected schemas">-->
              <!--<span class="ng-value-label">{{selectedLabel.filterName}}</span>-->
              <!--<span class="close"></span>-->
            <!--</div>-->

            <ng-template ng-label-tmp let-item="item" let-clear="clear">
              <div class="selected {{item.groupName.toLowerCase()}}">
                <span class="ng-value-label">{{item.filterName}}</span>
                <span class="close" (click)="clear(item)" aria-hidden="true"></span>
              </div>
            </ng-template>

            <ng-template ng-label-tmp let-clear="clear">
              <div *ngFor="let selectedValue of selected" class="selected {{selectedValue.groupName.toLowerCase()}}">
                <span class="ng-value-label">{{selectedValue.filterName}}</span>
                <span class="close" (click)="clear(selectedValue)" aria-hidden="true"></span>
              </div>
            </ng-template>
          </div>
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </section>
</aside>
<section class="search-wrapper">
  <ng-select [items]="autocomplete"
             [(ngModel)]="selected"
             [multiple]="true"
             (change)="groupSelected()"
             (add)="changeFilterState($event, true)"
             (clear)="changeFilterState()"
             (remove)="changeFilterState($event.value)"
             bindLabel="filterName"
             groupBy="groupName"
             clearAllText="Reset"
             placeholder="Search by..."
             class="pmm-select pmm-select--filter"
             role="combobox">
    <ng-template ng-label-tmp let-item="item" let-clear="clear">
      <div class="selected {{item.groupName.toLowerCase()}}">
        <span class="ng-value-label">{{item.groupName}}: {{item.filterName}}</span>
        <span class="close" (click)="clear(item)" aria-hidden="true"></span>
      </div>
    </ng-template>
    <ng-template ng-optgroup-tmp let-item="item">
      <span class="{{item.groupName.toLowerCase()}}">{{item.groupName}}</span>
    </ng-template>
  </ng-select>
</section>
